!function(){addEventListener("DOMContentLoaded",function(){window.applicationCache&&emy.plugin.appCache.init()}),emy.plugin.appCache={e:window.applicationCache,cachePrompt:null,busy:!1,init:function(){if(!emy.$("#cachePrompt")){var e=document.createElement("div");e.id="cachePrompt",emy.$("body")[0].appendChild(e)}this.e.addEventListener("checking",function(e){emy.plugin.appCache.eventListener(e)},!1),this.e.addEventListener("downloading",function(e){emy.plugin.appCache.eventListener(e)},!1),this.e.addEventListener("noupdate",function(e){emy.plugin.appCache.eventListener(e)},!1),this.e.addEventListener("updateready",function(e){emy.plugin.appCache.eventListener(e)},!1),this.e.addEventListener("progress",function(e){emy.plugin.appCache.eventListener(e)},!1),this.e.addEventListener("cached",function(e){emy.plugin.appCache.eventListener(e)},!1),this.e.addEventListener("error",function(e){emy.plugin.appCache.eventListener(e)},!1),this.e.addEventListener("obsolete",function(e){emy.plugin.appCache.eventListener(e)},!1)},eventListener:function(e){var t="";switch(e.type){case"noupdate":emy.log("** AppCache : NoUpdate **"),emy.plugin.appCache.busy=!1;break;case"cached":t="This app is now available offline!",emy.log("** AppCache : Cached **"),emy.plugin.appCache.busy=!1;break;case"checking":emy.log("** AppCache : Checking **");break;case"downloading":t="A new version is available",emy.log("** AppCache : Downloading **"),emy.plugin.appCache.busy=!0;break;case"progress":t="Downloading ("+parseInt(100*(e.loaded/e.total))+"%)",emy.log("** AppCache : Progress **");break;case"updateready":t="New version is ready! Restarting...",emy.log("** AppCache : UpdateReady **"),setTimeout(function(){window.location.reload()},1e3);break;case"obsolete":t="Cache manifest is obsolete.",emy.log("** AppCache : Obsolete **"),emy.plugin.appCache.busy=!1;break;case"error":emy.plugin.appCache.busy&&(t="An error has occured. Update failed"),emy.log("** AppCache : Error **"),emy.plugin.appCache.busy=!1}emy.plugin.appCache.updatePrompt(t,e.type)},updatePrompt:function(e,t){""!=e&&(emy.$("#cachePrompt").innerHTML="<p>"+e+"</p>",emy.$("#cachePrompt").style.display="block"),("error"==t||"cached"==t||"noupdate"==t)&&setTimeout(function(){emy.$("#cachePrompt").style.display="none"},1e3)}}}();